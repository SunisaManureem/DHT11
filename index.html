<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Temperature and Humidity Monitor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ---------- ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡πÑ‡∏ï‡∏•‡πå iOS (‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏°‡∏°‡πà‡∏ß‡∏á + glass) ---------- */
    :root{
      --glass: rgba(255,255,255,.14);
      --glass-strong: rgba(255,255,255,.22);
      --text: #f4f7fb;
      --muted: rgba(255,255,255,.85);
      --shadow: 0 20px 40px rgba(0, 20, 60, .25);
      --ring: inset 0 1px 0 rgba(255,255,255,.25), inset 0 -1px 0 rgba(0,0,0,.08);
      --card-blue: rgba(255,255,255,.16);
      --accent: #a7c8ff;
      --accent-2: #8ad1ff;
    }

    body{
      font-family: 'Poppins', sans-serif;
      margin: 0;
      min-height: 100vh;
      color: var(--text);
      background:
        radial-gradient(1200px 900px at 85% -5%, rgba(255,255,255,.16) 0%, rgba(255,255,255,0) 60%),
        linear-gradient(165deg, #143a84 0%, #3858b3 45%, #4f77d3 70%, #6aa6da 100%);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 24px;
    }

    /* ---------- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏ö‡∏ö glass ---------- */
    .widget{
      width: min(720px, 92vw);
      border-radius: 28px;
      background: var(--glass);
      backdrop-filter: blur(16px) saturate(120%);
      -webkit-backdrop-filter: blur(16px) saturate(120%);
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.24);
      overflow: hidden;
    }
    .widget-header{
      padding: 22px 26px 8px;
      border-bottom: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,0));
    }
    .title{
      font-size: clamp(22px, 3.8vw, 30px);
      font-weight: 700;
      letter-spacing: .3px;
      margin: 0;
      text-shadow: 0 1px 0 rgba(0,0,0,.3);
    }
    .widget-body{
      padding: 22px 26px 26px;
      display: grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 22px;
    }
    @media (max-width: 720px){
      .widget-body{ grid-template-columns: 1fr; gap: 18px; }
    }

    /* ---------- ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô iOS) ---------- */
    .temp-card{
      background: var(--glass-strong);
      border: 1px solid rgba(255,255,255,.26);
      border-radius: 22px;
      padding: 18px;
      box-shadow: var(--shadow);
      display:flex; align-items:center; justify-content:center;
      position:relative;
    }
    .temp-circle{
      width: min(360px, 72vw);
      max-width: 420px;
      aspect-ratio: 1/1;
      border-radius: 50%;
      background:
        radial-gradient(60% 60% at 50% 40%, rgba(255,255,255,.35) 0%, rgba(255,255,255,.08) 60%, rgba(255,255,255,0) 70%),
        linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.08));
      border: 1px solid rgba(255,255,255,.28);
      box-shadow: inset 0 10px 30px rgba(255,255,255,.15), inset 0 -18px 28px rgba(0,0,0,.15);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
    }
    .temp-label{
      color: var(--muted);
      font-size: 18px;
      margin-bottom: 4px;
    }
    .temp-value{
      font-size: clamp(52px, 10vw, 80px);
      font-weight: 700;
      letter-spacing: .5px;
      line-height: 1;
      text-shadow: 0 2px 0 rgba(0,0,0,.25);
    }
    .temp-unit{
      margin-top: 6px;
      color: var(--muted);
      font-weight: 600;
    }

    /* ---------- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô + ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ---------- */
    .right-col{ display:flex; flex-direction:column; gap: 18px; }
    .card{
      background: var(--card-blue);
      border: 1px solid rgba(255,255,255,.24);
      border-radius: 18px;
      padding: 18px 20px;
      box-shadow: var(--shadow);
    }
    .row{
      display:flex; align-items:baseline; justify-content:space-between; gap: 12px;
    }
    .label{
      font-size: 18px; color: var(--muted); font-weight:600; letter-spacing:.2px;
      display:flex; align-items:center; gap:8px;
    }
    .big{
      font-size: clamp(36px, 8vw, 56px);
      font-weight: 700;
      color: #eaf2ff;
      text-shadow: 0 2px 0 rgba(0,0,0,.25);
    }
    .unit{
      color: var(--muted); font-weight:600; margin-left: 6px;
    }

    /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (‡πÉ‡∏ä‡πâ id ‡πÄ‡∏î‡∏¥‡∏°) */
    .status-message{
      margin-top: 0;
      text-align:center;
      color: #0b1633;
      background: rgba(255,255,255,.85);
      border: 1px solid rgba(255,255,255,.9);
      border-radius: 14px;
      display: inline-block;
      padding: 10px 18px;
      box-shadow: 0 10px 24px rgba(0,0,0,.18);
    }

    /* ‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏Å‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö element/id ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ JS ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ */
    .legacy-container{ display:none; }
  </style>
</head>
<body>
  <!-- ‡∏ß‡∏¥‡∏î‡πÄ‡∏à‡πá‡∏ï‡∏´‡∏•‡∏±‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå iOS -->
  <div class="widget">
    <div class="widget-header">
      <h1 class="title">DHT11 Humidity and Temperature</h1>
    </div>

    <div class="widget-body">
      <!-- ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ -->
      <section class="temp-card">
        <div class="temp-circle">
          <div class="temp-label">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</div>
          <div class="temp-value" id="temperature-value">--</div>
          <div class="temp-unit">¬∞C</div>
        </div>
      </section>

      <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô + ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
      <section class="right-col">
        <div class="card">
          <div class="row">
            <div class="label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ó‡∏ò‡πå üíß</div>
            <div>
              <span class="big" id="humidity-value">--</span>
              <span class="unit">%</span>
            </div>
          </div>
        </div>

        <div class="card" style="display:flex;justify-content:center;align-items:center;">
          <div class="status-message" id="status-message">Connecting...</div>
        </div>
      </section>
    </div>
  </div>

  <!-- ‡πÄ‡∏Å‡πá‡∏ö DOM ‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏ß‡πâ (‡πÄ‡∏ú‡∏∑‡πà‡∏≠ JS ‡∏≠‡πâ‡∏≤‡∏á id ‡πÄ‡∏î‡∏¥‡∏°) ‡πÅ‡∏ï‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∏‡∏î -->
  <div class="legacy-container">
    <h1>DHT11 Humidity and Temperature Sensor</h1>
    <div class="container">
      <div class="card">
        <div class="label">Temperature <span class="emoji">üå°Ô∏è</span></div>
        <div class="value" id="temperature-value-legacy">--</div>
        <span class="unit">¬∞C</span>
      </div>
      <div class="card">
        <div class="label">Humidity <span class="emoji">üíß</span></div>
        <div class="value" id="humidity-value-legacy">--</div>
        <span class="unit">%</span>
      </div>
    </div>
  </div>

  <script>
    // ‡πÉ‡∏ä‡πâ‡πÇ‡∏î‡πÄ‡∏°‡∏ô backend ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
    const BACKEND_BASE = "https://dht11-2gtd.onrender.com";

    // map ‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á ‚Äú‡πÉ‡∏´‡∏°‡πà‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡πÄ‡∏Å‡πà‡∏≤ (‡∏ã‡πà‡∏≠‡∏ô)‚Äù ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ
    function setText(id, value){
      const el = document.getElementById(id);
      if (el) el.textContent = value;
    }

    async function fetchData() {
      try {
        const res = await fetch(`${BACKEND_BASE}/data`, { cache: "no-store" });
        const data = await res.json();

        if (data.temperature !== null) {
          setText("temperature-value", Number(data.temperature).toFixed(1));
          setText("temperature-value-legacy", Number(data.temperature).toFixed(1));
        }
        if (data.humidity !== null) {
          setText("humidity-value", Number(data.humidity).toFixed(1));
          setText("humidity-value-legacy", Number(data.humidity).toFixed(1));
        }
        setText("status-message", "Data updated ‚úÖ");
      } catch (err) {
        console.error("Fetch error:", err);
        setText("status-message", "Error fetching data ‚ö†Ô∏è");
      }
    }

    fetchData();
    setInterval(fetchData, 5000);
  </script>
</body>
</html>
